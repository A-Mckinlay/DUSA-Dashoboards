/*! Dashoboards - 2017-09-22
 */
"use strict";requirejs(["moment","Chart","lodash"],function(a,b,c){function d(a,b){var c=new Date(a),d=new Date(a);return d.setDate(d.getDate()-b),{start:d,end:c}}function e(){function a(a){return new Promise(function(b,c){var d=new XMLHttpRequest;d.open("GET",a,!0),d.onload=function(){200==d.status?b(d.response):c(d.statusText)},d.onerror=function(){c(d.statusText)},d.send()})}a("/api/meta/latestdate").then(function(b){var c=d(b,28),e="start="+c.start.toISOString()+"&end="+c.end.toISOString(),f="/api/sales/dailytx?"+e;return f=encodeURI(f),a(f)}).then(function(a){h(a)}).catch(function(a){console.log(a)})}function f(b){var d=JSON.parse(b),e=[];c.each(d,function(b,c){b.length>0&&e.push(a(c).unix())}),e.sort(function(a,b){return a-b});for(var f=[],g=0;g<e.length;g++)f[g]=a.unix(e[g]).format("DD/MM/YY");return f}function g(a){var b=JSON.parse(a);console.log(b);var d=[];c.each(b,function(a,b){b.length>0&&c.each(a,function(a,b){d.push(a.outletname)})});for(var e=new Set(d),f=Array.from(e),g=0;g<f.length;g++)c.each(b,function(a,b){console.log(b),c.each(a,function(a,b){console.log("data point: "+a.outletname+" "+a.totalamount)})})}function h(a){var c=f(a),d=g(a),e=document.getElementById("myChart");new b(e,{type:"line",data:{labels:c,datasets:[{label:d,data:[2,23,45,2,34,5,6,43],backgroundColor:["rgba(255, 99, 132, 0.2)"],borderColor:["rgba(255,99,132,1)"],borderWidth:1},{}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}e()});